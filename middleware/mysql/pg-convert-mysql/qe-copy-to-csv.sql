-- NULL -> ''
COPY (SELECT to_char(date, 'YYYY-MM-DD'), instrument_id, nav, fq_nav, dummy_id, close, daily_total_return, ms_daily_total_return, ms_fq_close, reuters_daily_total_return, bbg_daily_total_return, bbg_free_float_mktcap, amount, high, low, open, volume, choice_fq_factor, bbg_mkt_cap, bbg_money_flow, bbg_split_adj_close, bbg_total_shares_outstanding, choice_mktcap, choice_total_share, choice_turnover, choice_daily_total_return, clear, long_num, open_interest, reg_order_vol, short_num, inventory, bbg_turnover, adjust_factor, split_adjust_factor, ms_split_adjust_factor, vwap, reuters_mkt_cap, reuters_turnover, cn_stock_extra_data, cn_stock_flow_indicator, to_char(modification_datetime, 'YYYY-MM-DD HH:MI:SS') AS modification_datetime FROM market_data.pricing_data order by date ASC) To '/ali/rancher/pg-copy/pricing_data-ob_date.csv' With CSV DELIMITER ',' HEADER;
-- NULL -> NULL
-- COPY (SELECT to_char(date, 'YYYY-MM-DD'), instrument_id, nav, fq_nav, dummy_id, close, daily_total_return, ms_daily_total_return, ms_fq_close, reuters_daily_total_return, bbg_daily_total_return, bbg_free_float_mktcap, amount, high, low, open, volume, choice_fq_factor, bbg_mkt_cap, bbg_money_flow, bbg_split_adj_close, bbg_total_shares_outstanding, choice_mktcap, choice_total_share, choice_turnover, choice_daily_total_return, clear, long_num, open_interest, reg_order_vol, short_num, inventory, bbg_turnover, adjust_factor, split_adjust_factor, ms_split_adjust_factor, vwap, reuters_mkt_cap, reuters_turnover, cn_stock_extra_data, cn_stock_flow_indicator, to_char(modification_datetime, 'YYYY-MM-DD HH:MI:SS') AS modification_datetime FROM market_data.pricing_data) To '/ali/rancher/pg-copy/pricing_data.csv' WITH (FORMAT CSV, NULL 'NULL', HEADER);

-- to insert faster
-- split -d -l 10000 --additional-suffix=.csv pricing_data.csv pricing_data_part_